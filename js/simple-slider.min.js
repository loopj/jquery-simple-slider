/*
 * jQuery Simple Slider: Unobtrusive Numerical Slider
 * Version 1.0.0
 *
 * Forked by Greg Avola (http://gregavola.me) to add touch.
 *
 * Copyright (c) 2012 James Smith (http://loopj.com)
 *
 * Licensed under the MIT license (http://mit-license.org/)
 *
 */
var __slice=[].slice,__indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};(function(e,t){var n;n=function(){function n(n,r){var i,s=this;this.input=n;this.defaultOptions={animate:false,snapMid:false,classPrefix:null,classSuffix:null,theme:null};this.settings=e.extend({},this.defaultOptions,r);if(this.settings.theme){this.settings.classSuffix="-"+this.settings.theme}this.input.hide();this.slider=e("<div>").addClass("slider"+(this.settings.classSuffix||"")).css({position:"relative",userSelect:"none",boxSizing:"border-box"}).insertBefore(this.input);if(this.input.attr("id")){this.slider.attr("id",this.input.attr("id")+"-slider")}this.track=e("<div>").addClass("track").css({position:"absolute",top:"50%",width:"100%",userSelect:"none",cursor:"pointer"}).appendTo(this.slider);this.dragger=e("<div>").addClass("dragger").css({position:"absolute",top:"50%",userSelect:"none",cursor:"pointer"}).appendTo(this.slider);this.slider.css({minHeight:this.dragger.outerHeight(),marginLeft:this.dragger.outerWidth()/2,marginRight:this.dragger.outerWidth()/2});this.track.css({marginTop:this.track.outerHeight()/-2});this.dragger.css({marginTop:this.dragger.outerWidth()/-2,marginLeft:this.dragger.outerWidth()/-2});if("ontouchstart"in t){this.track.on("touchstart",function(e){if(jQuery){if(e.originalEvent.touches[0]){s.domDrag(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY);s.dragging=true}}else{if(e.touches[0]){s.domDrag(e.touches[0].pageX,e.touches[0].pageY);s.dragging=true}}return false});this.dragger.on("touchstart",function(e){if(jQuery){if(e.originalEvent.touches[0]){s.dragging=true;s.dragger.addClass("dragging");s.domDrag(e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY)}return false}else{console.log(jQuery);if(e.touches[0]){s.dragging=true;s.dragger.addClass("dragging");s.domDrag(e.touches[0].pageX,e.touches[0].pageY)}return false}});e(t).on("touchmove",function(t){if(jQuery){if(s.dragging){s.domDrag(t.originalEvent.touches[0].pageX,t.originalEvent.touches[0].pageY);return e("body").css({cursor:"pointer"})}}else{if(s.dragging){s.domDrag(t.touches[0].pageX,t.touches[0].pageY);return e("body").css({cursor:"pointer"})}}});e(t).on("touchend",function(t){if(s.dragging){s.dragging=false;s.dragger.removeClass("dragging");return e("body").css({cursor:"auto"})}})}else{this.track.mousedown(function(e){if(e.which!==1){return}s.domDrag(e.pageX,e.pageY,true);s.dragging=true;return false});this.dragger.mousedown(function(e){if(e.which!==1){return}s.dragging=true;s.dragger.addClass("dragging");s.domDrag(e.pageX,e.pageY);return false});e(t).mousemove(function(t){if(s.dragging){s.domDrag(t.pageX,t.pageY);return e("body").css({cursor:"pointer"})}}).mouseup(function(t){if(s.dragging){s.dragging=false;s.dragger.removeClass("dragging");return e("body").css({cursor:"auto"})}})}this.pagePos=0;if(this.input.val()===""){this.value=this.getRange().min;this.input.val(this.value)}else{this.value=this.nearestValidValue(this.input.val())}this.setSliderPositionFromValue(this.value);i=this.valueToRatio(this.value);this.input.trigger("slider:ready",{value:this.value,ratio:i,position:i*this.slider.outerWidth(),el:this.slider})}n.prototype.setRatio=function(e){var t;e=Math.min(1,e);e=Math.max(0,e);t=this.ratioToValue(e);this.setSliderPositionFromValue(t);return this.valueChanged(t,e,"setRatio")};n.prototype.setValue=function(e){var t;e=this.nearestValidValue(e);t=this.valueToRatio(e);this.setSliderPositionFromValue(e);return this.valueChanged(e,t,"setValue")};n.prototype.domDrag=function(e,t,n){var r,i,s;if(n==null){n=false}r=e-this.slider.offset().left;r=Math.min(this.slider.outerWidth(),r);r=Math.max(0,r);if(this.pagePos!==r){this.pagePos=r;i=r/this.slider.outerWidth();s=this.ratioToValue(i);this.valueChanged(s,i,"domDrag");if(this.settings.snap){return this.setSliderPositionFromValue(s,n)}else{return this.setSliderPosition(r,n)}}};n.prototype.setSliderPosition=function(e,t){if(t==null){t=false}if(t&&this.settings.animate){console.log(animating);return this.dragger.animate({left:e},200)}else{return this.dragger.css({left:e})}};n.prototype.setSliderPositionFromValue=function(e,t){var n;if(t==null){t=false}n=this.valueToRatio(e);return this.setSliderPosition(n*this.slider.outerWidth(),t)};n.prototype.getRange=function(){if(this.settings.allowedValues){return{min:Math.min.apply(Math,this.settings.allowedValues),max:Math.max.apply(Math,this.settings.allowedValues)}}else if(this.settings.range){return{min:parseFloat(this.settings.range[0]),max:parseFloat(this.settings.range[1])}}else{return{min:0,max:1}}};n.prototype.nearestValidValue=function(t){var n,r,i,s;i=this.getRange();t=Math.min(i.max,t);t=Math.max(i.min,t);if(this.settings.allowedValues){n=null;e.each(this.settings.allowedValues,function(){if(n===null||Math.abs(this-t)<Math.abs(n-t)){return n=this}});return n}else if(this.settings.step){r=(i.max-i.min)/this.settings.step;s=Math.floor((t-i.min)/this.settings.step);if((t-i.min)%this.settings.step>this.settings.step/2&&s<r){s+=1}return s*this.settings.step+i.min}else{return t}};n.prototype.valueToRatio=function(e){var t,n,r,i,s,o,u,a;if(this.settings.equalSteps){a=this.settings.allowedValues;for(i=o=0,u=a.length;o<u;i=++o){t=a[i];if(!(typeof n!=="undefined"&&n!==null)||Math.abs(t-e)<Math.abs(n-e)){n=t;r=i}}if(this.settings.snapMid){return(r+.5)/this.settings.allowedValues.length}else{return r/(this.settings.allowedValues.length-1)}}else{s=this.getRange();return(e-s.min)/(s.max-s.min)}};n.prototype.ratioToValue=function(e){var t,n,r,i,s;if(this.settings.equalSteps){s=this.settings.allowedValues.length;i=Math.round(e*s-.5);t=Math.min(i,this.settings.allowedValues.length-1);return this.settings.allowedValues[t]}else{n=this.getRange();r=e*(n.max-n.min)+n.min;return this.nearestValidValue(r)}};n.prototype.valueChanged=function(t,n,r){var i;if(t.toString()===this.value.toString()){return}this.value=t;i={value:t,ratio:n,position:n*this.slider.outerWidth(),trigger:r,el:this.slider};return this.input.val(t).trigger(e.Event("change",i)).trigger("slider:changed",i)};return n}();e.extend(e.fn,{simpleSlider:function(){var t,r,i;i=arguments[0],t=2<=arguments.length?__slice.call(arguments,1):[];r=["setRatio","setValue"];return e(this).each(function(){var s,o;if(i&&__indexOf.call(r,i)>=0){s=e(this).data("slider-object");return s[i].apply(s,t)}else{o=i;return e(this).data("slider-object",new n(e(this),o))}})}});return e(function(){return e("[data-slider]").each(function(){var t,n,r,i;t=e(this);r={};n=t.data("slider-values");if(n){r.allowedValues=function(){var e,t,r,s;r=n.split(",");s=[];for(e=0,t=r.length;e<t;e++){i=r[e];s.push(parseFloat(i))}return s}()}if(t.data("slider-range")){r.range=t.data("slider-range").split(",")}if(t.data("slider-step")){r.step=t.data("slider-step")}r.snap=t.data("slider-snap");r.equalSteps=t.data("slider-equal-steps");if(t.data("slider-theme")){r.theme=t.data("slider-theme")}return t.simpleSlider(r)})})})(this.jQuery||this.Zepto,this)
